# Optuna hyperparameter optimization configuration

# Study settings
study:
  study_name: "stepmania_optimization"
  storage: "sqlite:///optuna_study.db"
  direction: "maximize"  # For classification accuracy
  n_trials: 100

# Hyperparameter search spaces
classifier_search_space:
  # Learning rate
  learning_rate:
    type: "loguniform"
    low: 1e-5
    high: 1e-2

  # Batch size
  batch_size:
    type: "categorical"
    choices: [16, 32, 64, 128]

  # Model architecture
  audio_encoder_hidden_dim:
    type: "categorical"
    choices: [128, 256, 512]

  chart_encoder_hidden_dim:
    type: "categorical"
    choices: [128, 256, 512]

  fusion_dim:
    type: "categorical"
    choices: [256, 512, 1024]

  # Dropout rates
  encoder_dropout:
    type: "uniform"
    low: 0.0
    high: 0.3

  classifier_dropout:
    type: "uniform"
    low: 0.1
    high: 0.5

  # Training
  weight_decay:
    type: "loguniform"
    low: 1e-6
    high: 1e-1

diffusion_search_space:
  # Learning rate
  learning_rate:
    type: "loguniform"
    low: 1e-5
    high: 1e-2

  # Batch size
  batch_size:
    type: "categorical"
    choices: [8, 16, 32, 64]

  # Model architecture
  base_channels:
    type: "categorical"
    choices: [32, 64, 128]

  num_res_blocks:
    type: "categorical"
    choices: [1, 2, 3]

  # Diffusion process
  diffusion_steps:
    type: "categorical"
    choices: [500, 1000, 2000]

  noise_schedule:
    type: "categorical"
    choices: ["linear", "cosine"]

  # Training
  weight_decay:
    type: "loguniform"
    low: 1e-6
    high: 1e-1

# Pruning
pruning:
  enabled: true
  patience: 5  # Number of epochs to wait before pruning